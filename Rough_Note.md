# 개인 필기  

## issues 4
## 가장 많이 사용하는 내장함수
### 1. 문자열  
Concept, upper, lower, replace  

### 2. 수학  
Round, ceil, floor()  

### 3. 날짜/시간  
now, date, year  

### 4. 집계함수  
Sum, count, avg, max, min  

### 5. 조건함수
if, innull, case  

VARCHAR
DATE
FLOAT
DOUBLE
INT
DECIMAL : 고정 소수점 // EX)앞은 7자리, 소수점 뒤에 정확히 두자리 까지 하겠다 (7,2) // 
뒤에 소수점이 마음대로 붙기도 함. SO, 정확하게 안됨.
--> 금융권 데이터는 (소수점의 자리수를 표현하는)FLOAT, DOUBLE 중 뭘 쓸까? -> 느리지만 정확한 DECIMAL를 씀.
--
숫자 데이터 형식 중 많이 쓰는 타입들 특이한 타입들 
TINYINT -> 한자리 숫자를 사용할 때, 1BYTE만 차지해서 자주 씀.
엄청나게 긴 논문 같은건 TEXT형식 중 LONGTEXT를 쓰기도 함.
BLOB -> 텍스트 뿐 아니라, 이미지, 동영상 등 
LONGBLOB은 4GB까지 저장 가능

ENUM
SET
Gender ENUM(1, 2, 3, 4)
-> 하나의 값만 컬럼에 넣을 수 있음.
SET(, , , ) 여러개의 값을 컬러멩 넣을 수 있음.


- insert
- DATETIME 
- TIMESTAMP ->
- YEAR

##### 문자열 함수
- 대문자 소문자 서로 바꾸기
- ID : abc12 일 떄, 무조건 ABC12로 자동변환해서 내부적으로 변환해서 비교함.
- -> UPPER(대문자로바꿈) / LOWER

##### 날짜 및 시간 함수
- 다른 건 몰라도 NOW 하나는 알아둬라 


### 정규화

## 조인, 집합

집합은 just 합하는 것.
UNION, UNION ALL, NOT IN, IN

조인은
 inner join
 left join
 right join

 먼저쓴게 lift고, 나중에 쓴게 right다.

서브쿼리 및 기타 내용 

---
## 5. 19.월
데이터형식   
CHAR(n) / VARCHAR(n)  두개 구분은 아주 기본.

CHAR  
TEXT  
BLOB  
ENUM  
SET  

### 날짜
NOW 정말 많이 씀

### 집합  -> 실무에서 사용빈도는 적지만 쉬운 것이니 알아둘 것.
UNION : 단순 합침  
UNION ALL : 중복제거 후 합침  
/ NOT IN / IN

#### JOIN 
1. INNER JOIN (TABLE1 ∩ TABLE2)
2. LEFT JOIN (TABLE1 ∋ TABLE2)
3. RIGHT JOIN! (TABLE1 ∈ TABLE2)
4. [image](https://github.com/user-attachments/assets/7d6b98f8-c44f-4a61-8cd2-a2daa00a8063)


///

#### 문법
AS 
NAME AS
ON

## 강사님 필기
👍 뷰

MySQL 8에서 **기본 테이블(Base Table)**을 삭제(DROP TABLE)하더라도, 해당 테이블을 기반으로 만든 **뷰(View)**는 자동으로 삭제되지 않음.

⸻

1. 테이블 삭제 시 뷰는 사라지지 않는다
• DROP TABLE 원본테이블명; 명령을 실행해도, 그 테이블을 참조하고 있던 뷰(CREATE VIEW ...)는 데이터베이스에 그대로 남아 있음
• 하지만 그 뷰는 “깨진 상태(broken view)“가 되어 사용할 수 없음
• 이후 그 뷰를 사용하려고 하면 다음과 같은 에러가 발생

ERROR 1356 (HY000): View '뷰이름' references invalid table(s) or column(s) or function(s) or definer/invoker of view lack rights to use them

⸻

2. 뷰를 확인하려면

SHOW FULL TABLES IN 데이터베이스명 WHERE TABLE_TYPE = 'VIEW';

⸻

3. 뷰를 다시 사용하려면
• 뷰가 참조하는 원본 테이블이 존재해야함.
• 테이블을 복원하거나, 뷰를 다시 정의(CREATE OR REPLACE VIEW) 해야함.

⸻

4. 뷰를 함께 정리하려면
• 뷰를 먼저 삭제한 후, 테이블을 삭제하는 것이 안전
• 또는, 의존 관계를 분석할 수 있음.
1. SHOW CREATE VIEW 뷰이름; 으로 어떤 테이블을 참조하는지 확인
2. DROP VIEW 뷰이름;
3. DROP TABLE 테이블이름;

⸻

## 복합키
※ 권장사항은 아님  
두개 이상의 column을 결합, 하나의 pk/uk 구성
-> 복합키가 pk가 될 수 있음.
-> 하나가 unique, null이 안되는 경우
-> 여러개 컬럼을 결합 했을 대, pk조건에 만족하는 경우

userid / productid / price / buytbl  
apple, 100, 1000, 2025-05-19  
apple, 200, 2000, 2025-05-20  

memeber userid(pk) - apple, ice
board boardid(pk), userid(fk) - 1: apple, 2: ice, 3: apple

외래키 옵션 조선 / 제약 조건
ON DELETE CASCATE // ON UPDATE CASCADE

ALTER TABLE buyTBL
ADD CONSTRAINT FK_userTBLbuyTBL
FOREIGN KEY(userID)
REFERENCES

# 정규화
기본키 후보키 대체키 복합키 외래키 

| 용어                       | 정의                                       | 예시              |
| ------------------------ | ---------------------------------------- | --------------- |
| **엔티티(Entity)**          | 현실 세계의 **객체 또는 개념을 표현한 것**               | 학생, 도서, 직원      |
| **속성(Attribute)**        | 엔티티가 가진 **특성**                           | 이름, 학번, 나이      |
| **키(Key)**               | 엔티티 인스턴스를 **유일하게 식별**할 수 있는 속성(또는 속성 조합) | 학번(student\_id) |
| **인스턴스(Instance)**       | 실제 데이터. **엔티티의 한 개체**                    | 철수, 학번 2023001  |
| **속성값(Attribute Value)** | 인스턴스가 가진 **속성의 실제 값**                    | 이름=철수, 나이=20    |


| 키 종류 | 유일함 | NULL 허용 | 개수 제한 | 역할             |
| ---- | --- | ------- | ----- | -------------- |
| 기본키  | O   | X       | 1개    | 행의 고유 식별자      |
| 후보키  | O   | X       | 여러 개  | 기본키 후보         |
| 대체키  | O   | X       | 여러 개  | 후보키 중 기본키 아닌 것 |
| 복합키  | O   | X       | 1개    | 여러 컬럼 조합 기본키   |
| 외래키  | X   | O (기본값) | 여러 개  | 다른 테이블의 기본키 참조 |

| 키 종류    | 정의                                    | 주요 특징                                                                 |
| ------- | ------------------------------------- | --------------------------------------------------------------------- |
| **기본키** | 테이블에서 각 행을 **유일하게 식별**하는 속성 또는 속성의 조합 | - `UNIQUE`, `NOT NULL` 반드시 만족<br>- 한 테이블에 하나만 존재<br>- 자동 인덱스 생성       |
| **후보키** | 기본키로 **선택 가능한 모든 속성들**                | - `UNIQUE` 조건 만족<br>- 여러 개 존재 가능<br>- 하나가 기본키로 선택되고 나머지는 대체키로 분류      |
| **대체키** | 후보키 중에서 **기본키로 선택되지 않은** 키            | - `UNIQUE` 속성을 유지<br>- NULL 허용 여부는 설계에 따라 다름<br>- 종종 `UNIQUE` 제약으로 설정 |
| **복합키** | 두 개 이상의 컬럼을 조합하여 만든 키                 | - 단일 컬럼으로는 유일성 부족할 때 사용<br>- 조합된 모든 컬럼을 기준으로 유일성 보장                   |
| **외래키** | 다른 테이블의 **기본키나 후보키를 참조**하는 키          | - 테이블 간 관계 설정<br>- 참조 무결성 보장<br>- `ON DELETE`, `ON UPDATE` 제약 가능      |


##### 🔧 정규화의 목적
###### 데이터 중복 제거
###### 삽입, 삭제, 갱신 이상(Anomaly) 방지
###### 데이터 무결성 유지
###### 유지보수 용이성 향상

| 단계         | 핵심 개념                 | 제거하는 문제                          |
| ---------- | --------------------- | -------------------------------- |
| 제1정규형(1NF) | 원자값(Atomic Value)만 저장 | 반복 그룹(Removing Repeating Groups) |
| 제2정규형(2NF) | 부분 함수 종속 제거           | 삽입/삭제 이상                         |
| 제3정규형(3NF) | 이행적 함수 종속 제거          | 중복된 비핵심 정보                       |
| BCNF       | 결정자가 후보키가 아닌 경우 제거    | 더 엄격한 3NF                        |
| 4NF        | 다치 종속 제거              | 테이블 내 다중값 종속 제거                  |
| 5NF        | 조인 종속 제거              | 무손실 분해 불가능한 조인 해결                |

## 트랜젝션

##### **트랜잭션(Transaction)**이란, 하나의 작업 단위를 구성하는 일련의 데이터베이스 연산 묶음을 의미. 이 연산들은 모두 성공하거나 모두 실패해야 하며, 중간에 일부만 실행된 상태로는 남지 않음.
##### 트랜잭션은 데이터의 **정합성(일관성)**을 유지하기 위해 존재

| 요소                       | 설명                                      |
| ------------------------ | --------------------------------------- |
| **A (Atomicity, 원자성)**   | 전부 수행되거나 전부 수행되지 않아야 함 (All or Nothing) |
| **C (Consistency, 일관성)** | 트랜잭션 전후의 데이터가 일관성 있는 상태여야 함             |
| **I (Isolation, 독립성)**   | 동시에 실행되는 트랜잭션끼리 서로 간섭하지 않아야 함           |
| **D (Durability, 지속성)**  | 성공한 트랜잭션의 결과는 시스템에 영구적으로 반영되어야 함        |

| 명령어                            | 설명                  |
| ------------------------------ | ------------------- |
| `START TRANSACTION` 또는 `BEGIN` | 트랜잭션 시작             |
| `COMMIT`                       | 트랜잭션 완료 및 변경 사항 저장  |
| `ROLLBACK`                     | 트랜잭션 중단 및 변경 사항 되돌림 |
| `SAVEPOINT`                    | 트랜잭션 내 중간 저장점 설정    |
| `ROLLBACK TO SAVEPOINT`        | 특정 저장점까지 되돌림        |

####  📌 왜 필요한가?
##### 예: 계좌 이체 도중 첫 번째 계좌에서 돈은 빠졌는데, 두 번째 계좌에 입금은 실패했다면?
##### → 데이터 불일치 발생. 트랜잭션을 사용하면 이런 상황을 방지할 수 있습니다.
